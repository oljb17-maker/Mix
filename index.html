<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kairos Mix — Basic Detailing</title>

<style>
  :root{ --radius:18px; }

  /* App variables on #app (Dark default) */
  #app{
    --bg0:#050814; --bg1:#071225; --bg2:#0b1a33;
    --glass: rgba(9,16,35,.70);
    --line: rgba(120,180,255,.22);
    --txt:#eaf2ff;
    --muted: rgba(234,242,255,.72);
    --accent1:#7a5cff; --accent2:#23d5ff;
    --warnBG: rgba(255,170,66,.10);
    --warnLine: rgba(255,170,66,.28);
    --okBG: rgba(0,255,170,.10);
    --okLine: rgba(0,255,170,.25);

    min-height:100vh;
    padding:16px;
    background:
      radial-gradient(1000px 600px at 10% 10%, rgba(122,92,255,.35), transparent 55%),
      radial-gradient(900px 500px at 85% 15%, rgba(35,213,255,.25), transparent 55%),
      linear-gradient(160deg,var(--bg0),var(--bg1) 40%, var(--bg2));
    color:var(--txt);
    font-family:-apple-system,system-ui,Segoe UI,Roboto,Arial;
  }

  /* Light mode */
  #app[data-mode="light"]{
    --bg0:#f6f8ff; --bg1:#eef2ff; --bg2:#e9eeff;
    --glass: rgba(255,255,255,.78);
    --line: rgba(10,18,48,.14);
    --txt:#0a1230;
    --muted: rgba(10,18,48,.70);
    --accent1:#3456ff; --accent2:#00b7ff;
    --warnBG: rgba(255,170,66,.18);
    --warnLine: rgba(255,170,66,.35);
    --okBG: rgba(0,160,110,.12);
    --okLine: rgba(0,160,110,.25);

    background:
      radial-gradient(1000px 600px at 10% 10%, rgba(52,86,255,.16), transparent 55%),
      radial-gradient(900px 500px at 85% 15%, rgba(0,183,255,.12), transparent 55%),
      linear-gradient(160deg,var(--bg0),var(--bg1) 40%, var(--bg2));
  }

  .card{
    max-width:980px;
    margin:0 auto;
    background:var(--glass);
    border:1px solid var(--line);
    border-radius:var(--radius);
    padding:16px;
    box-shadow:0 12px 50px rgba(0,0,0,.35);
    backdrop-filter: blur(10px);
  }

  .top{
    display:flex; gap:12px; align-items:center; justify-content:space-between; flex-wrap:wrap;
  }
  .brand{ display:flex; flex-direction:column; gap:2px; }
  .brand .k{ font-weight:900; letter-spacing:.24em; opacity:.95; }
  .brand .t{ font-size:12px; color:var(--muted); }

  .pill{
    padding:8px 12px;
    border-radius:999px;
    border:1px solid var(--line);
    background: linear-gradient(135deg, rgba(122,92,255,.20), rgba(35,213,255,.12));
    font-weight:900;
    letter-spacing:.08em;
    font-size:12px;
    white-space:nowrap;
  }
  #app[data-mode="light"] .pill{
    background: linear-gradient(135deg, rgba(52,86,255,.14), rgba(0,183,255,.08));
  }

  .row{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
  .row > *{ flex:1 1 190px; }

  select, input, button{
    width:100%;
    padding:12px;
    border-radius:14px;
    border:1px solid var(--line);
    background: rgba(5,10,22,.45);
    color:var(--txt);
    font-weight:900;
  }
  #app[data-mode="light"] select,
  #app[data-mode="light"] input,
  #app[data-mode="light"] button{
    background: rgba(255,255,255,.72);
  }

  button.action{
    background: linear-gradient(135deg, rgba(122,92,255,.18), rgba(35,213,255,.10));
  }
  #app[data-mode="light"] button.action{
    background: linear-gradient(135deg, rgba(52,86,255,.14), rgba(0,183,255,.08));
  }

  .small{ font-size:13px; color:var(--muted); margin-top:10px; }
  .grid{
    display:grid;
    grid-template-columns: repeat(2, minmax(0,1fr));
    gap:10px;
    margin-top:8px;
  }
  @media (max-width:680px){ .grid{ grid-template-columns: 1fr; } }

  .out{
    margin-top:14px;
    padding:14px;
    border-radius:16px;
    border:1px solid var(--line);
    background: rgba(5,10,22,.35);
  }
  #app[data-mode="light"] .out{ background: rgba(255,255,255,.68); }

  .big{ font-size:20px; font-weight:900; margin-top:6px; }

  .hint{
    margin-top:10px;
    padding:10px;
    border-radius:14px;
    border:1px solid var(--okLine);
    background: var(--okBG);
  }

  .warn{
    margin-top:10px;
    padding:10px;
    border-radius:14px;
    border:1px solid var(--warnLine);
    background: var(--warnBG);
  }

  .tabs{
    display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;
  }
  .tabs button{
    flex: 1 1 180px;
  }

  hr{
    border:none;
    height:1px;
    background: linear-gradient(90deg, transparent, var(--line), transparent);
    margin:14px 0;
  }

  .hidden{ display:none !important; }
</style>
</head>

<body>
<div id="app" data-mode="dark">
  <div class="card">
    <div class="top">
      <div class="brand">
        <div class="k">KAIROS</div>
        <div class="t">Mix • Basic Detailing • Diluciones (Agua:APC)</div>
      </div>
      <div class="pill" id="activePill">PRESET: —</div>
    </div>

    <div class="row">
      <select id="uiMode">
        <option value="dark" selected>Modo oscuro (actual)</option>
        <option value="light">Modo claro</option>
      </select>

      <select id="total">
        <option value="250">250 ml</option>
        <option value="500" selected>500 ml</option>
        <option value="750">750 ml</option>
        <option value="1000">1000 ml</option>
      </select>

      <select id="measure">
        <option value="exact" selected>Exacto (vaso graduado)</option>
        <option value="easy">Redondeado seguro</option>
      </select>

      <input id="customRatio" type="number" min="1" step="1" value="12" placeholder="Custom ratio (agua:APC)" />
    </div>

    <div class="small">Sección</div>
    <div class="tabs">
      <button class="action" id="tabInterior">INTERIOR</button>
      <button class="action" id="tabExterior">EXTERIOR</button>
    </div>

    <div id="interiorBlock">
      <div class="small">INTERIOR presets (plástico/cuero). “Color” = custom ratio.</div>
      <div class="grid">
        <button class="action" onclick="setPreset('Interior oscuro', 10, 'interior')">Interior: Oscuro</button>
        <button class="action" onclick="setPreset('Interior oscuro/gris', 12, 'interior')">Interior: Oscuro/Gris</button>
        <button class="action" onclick="setPreset('Interior claro', 15, 'interior')">Interior: Claro</button>
        <button class="action" onclick="setPreset('Interior claro/gris', 15, 'interior')">Interior: Claro/Gris</button>
        <button class="action" onclick="setPreset('Interior: Color (custom)', getCustomRatio(), 'interior')">Interior: Color (custom)</button>
        <button class="action" onclick="setPreset('Interior ultra suave', 20, 'interior')">Interior: Ultra suave</button>
      </div>
    </div>

    <div id="exteriorBlock" class="hidden">
      <div class="small">EXTERIOR presets (sin espejos/vidrios).</div>
      <div class="grid">
        <button class="action" onclick="setPreset('Exterior: Bug remover', 12, 'exterior')">Bug remover</button>
        <button class="action" onclick="setPreset('Exterior: Llantas + Rines (1 líquido)', 6, 'exterior')">Llantas + Rines (1 líquido)</button>
        <button class="action" onclick="setPreset('Exterior: Body + Plástico externo', 15, 'exterior')">Body + Plástico externo</button>
        <button class="action" onclick="setPreset('Exterior: Motor + Bajo capó', 10, 'exterior')">Motor + Bajo capó</button>
      </div>
      <div class="small">*Vidrios y espejos NO incluidos (usas tu líquido aparte).</div>
    </div>

    <div class="out">
      <div class="small" id="label">Elige un preset.</div>
      <div class="big" id="mix">—</div>
      <div class="small" id="meta">—</div>
      <div class="hint" id="hint">—</div>
      <div class="warn" id="warn" style="display:none">—</div>
    </div>

    <hr>
    <div class="small">
      Fórmula: <b>APC = Total / (ratio + 1)</b> • <b>Agua = Total − APC</b> (ratio = agua:APC).<br>
      Regla: <b>No dejar secar</b>. Trabaja en sombra y superficie fría.
    </div>
  </div>
</div>

<script>
  // ====== State ======
  let currentPreset = { name: null, ratio: null, kind: null };

  const app = document.getElementById("app");
  const uiMode = document.getElementById("uiMode");
  const totalSel = document.getElementById("total");
  const measureSel = document.getElementById("measure");
  const customRatioInp = document.getElementById("customRatio");

  const pill = document.getElementById("activePill");
  const label = document.getElementById("label");
  const mix = document.getElementById("mix");
  const meta = document.getElementById("meta");
  const hint = document.getElementById("hint");
  const warn = document.getElementById("warn");

  // Tabs
  const tabInterior = document.getElementById("tabInterior");
  const tabExterior = document.getElementById("tabExterior");
  const interiorBlock = document.getElementById("interiorBlock");
  const exteriorBlock = document.getElementById("exteriorBlock");

  tabInterior.addEventListener("click", ()=>{
    interiorBlock.classList.remove("hidden");
    exteriorBlock.classList.add("hidden");
  });
  tabExterior.addEventListener("click", ()=>{
    exteriorBlock.classList.remove("hidden");
    interiorBlock.classList.add("hidden");
  });

  // ====== Helpers ======
  function getCustomRatio(){
    const r = parseInt(customRatioInp.value, 10);
    return (Number.isFinite(r) && r >= 1) ? r : 12;
  }

  function roundEasy(total, ratio){
    // simple + safe rounding to nearest 5ml for APC
    const apcExact = total / (ratio + 1);
    return Math.max(5, Math.round(apcExact / 5) * 5);
  }

  function setPreset(name, ratio, kind){
    // kind: 'interior' | 'exterior'
    ratio = parseInt(ratio, 10);
    if (!Number.isFinite(ratio) || ratio < 1) ratio = 12;

    currentPreset = { name, ratio, kind };
    pill.textContent = `PRESET: ${name.toUpperCase()}`;
    compute();
  }

  function compute(){
    if (!currentPreset.ratio){
      label.textContent = "Elige un preset.";
      mix.textContent = "—";
      meta.textContent = "—";
      hint.textContent = "—";
      warn.style.display = "none";
      return;
    }

    const total = parseFloat(totalSel.value);
    const ratio = currentPreset.ratio;
    const measure = measureSel.value;

    let apc = total / (ratio + 1);
    if (measure === "easy") apc = roundEasy(total, ratio);

    const water = total - apc;

    mix.textContent = `APC ${apc.toFixed(measure==="easy"?0:1)} ml  •  Agua ${water.toFixed(measure==="easy"?0:1)} ml`;
    meta.textContent = `${ratio}:1 (agua:APC) • Total ${total} ml • Medición: ${measure}`;

    label.textContent = currentPreset.name;

    // Context instructions
    warn.style.display = "none";
    warn.textContent = "";

    if (currentPreset.kind === "interior"){
      if (ratio >= 15){
        hint.innerHTML = "Interior claro: rocía en microfibra (no directo), limpia suave y seca inmediato. Evita empapar botones.";
      } else if (ratio >= 12){
        hint.innerHTML = "Interior normal: microfibra + 2 pasadas si hace falta. No dejar residuo, seca al final.";
      } else {
        hint.innerHTML = "Interior más fuerte: úsalo solo en zonas resistentes (umbral/plásticos bajos). Prueba en un área pequeña.";
        warn.style.display = "block";
        warn.textContent = "⚠️ Mezcla fuerte para interior: evita tablero delicado, piano black y zonas sensibles.";
      }
      return;
    }

    // Exterior
    const n = currentPreset.name.toLowerCase();

    if (n.includes("bug")){
      hint.innerHTML = "Bug remover: aplicar en frío, esperar 30–60s, retirar con microfibra húmeda y enjuagar. No raspar en seco.";
      return;
    }

    if (n.includes("llantas") || n.includes("rines")){
      hint.innerHTML = "Llantas + rines (1 líquido 6:1): aplicar en frío, 30–45s, cepillar primero llanta y luego rin, enjuagar fuerte. No dejar secar.";
      warn.style.display = "block";
      warn.textContent = "⚠️ Evita superficies calientes. Si el rin es delicado (cromo viejo/pulido), usa más suave (10:1).";
      return;
    }

    if (n.includes("body")){
      hint.innerHTML = "Body + plástico externo: ideal para insectos ligeros y grasa suave. Trabaja por secciones y enjuaga bien.";
      warn.style.display = "block";
      warn.textContent = "⚠️ No usar como shampoo en toda la carrocería: úsalo puntual y enjuaga. Evita que se seque.";
      return;
    }

    if (n.includes("motor")){
      hint.innerHTML = "Motor + bajo capó: motor frío, evita alternador/fusibles/sensores, brocha suave, enjuague ligero y secar.";
      warn.style.display = "block";
      warn.textContent = "⚠️ No empapar conectores. No trabajar con motor caliente.";
      return;
    }

    hint.innerHTML = "Exterior: trabajar en sombra/superficie fría. No dejar secar. Enjuagar bien.";
  }

  // ====== UI mode (dark/light) ======
  uiMode.addEventListener("change", ()=>{
    app.setAttribute("data-mode", uiMode.value);
    localStorage.setItem("kairos_mix_basic_uimode", uiMode.value);
  });

  // Recompute if sizing/measure/custom changes
  [totalSel, measureSel, customRatioInp].forEach(el=>{
    el.addEventListener("change", ()=>{ if(currentPreset.ratio) compute(); });
    el.addEventListener("input", ()=>{ /* live update for custom */ });
  });

  // Restore mode
  const savedMode = localStorage.getItem("kairos_mix_basic_uimode");
  if (savedMode){
    uiMode.value = savedMode;
    app.setAttribute("data-mode", savedMode);
  }

  // Default starting preset (safe interior)
  setPreset("Interior claro/gris", 15, "interior");
</script>
</body>
</html>